一、区块结构：
1）10分钟一个高度，每个高度至少生产一个块；
2）一个高度一次共识，即一次选举；
3）每个高度选举下一高度的提案者和验证者；
4）主链每10分钟生产一个主块和生产N个子块，子块生产间隔时间最小10秒，当没有交易时，则不生产子块；
5）子链每10分钟生产一个主块和生产N个子块，当没有交易时，则不生产子块；子块最小间隔时间，由创建子链时设置（最大间隔时间不超过10秒）；
6）每个高度选举出N个提案者（提案者数量由侯选验证节点数决定），主链一块由一个提案者生产，子链每10秒一个提案者，提案者完成10秒的所有块生产；
7）提案者数量小于子块数量的，则轮循排列，如有A、B、C三个提案者，需要生产10个主链的块，则排列为ABCABCABCA（排列顺序由随机数决定）；
8）提案者完成最后一块生产后，会广播提案结束消息，下一提案者接收到该消息，就可以开始生产块；如果提案者所在时间段无交易而不生产块，则只广播提案结束消息；如果下一提案者超时未收到提案结束消息，则在最后一块继续生产块；（恶意不广播提案结束消息或者恶意分叉的给于惩罚）
9）为提高提案结束消息准确性和及时性，则由独立P2P网络传输该消息（与共识传输同P2P网络），提高提案者接收提案结束消息的及时性；（P2P网络分区：1、共识传输P2P网络，2、区块传输P2P网络，3、交易传输P2P网络）
10）如果提案者在该生产区块的时段，未生产区块，并且也未广播提案结束消息，则下一个提案者超时未收到提案结束消息后，继续生产区块；超时时间为生产时段的1/4（如时段为10秒，则超时时长为2.5秒）；超时后，提案者加速生产区块（直到追上原生产计划的时间），但区块时间戳还是按原计划生产；（对该类提案者给于惩罚）
11）主链和子链的主块之间有直接关联，即一个主块头中包含有上一个主块的块HASH，该关联可用于块快速较验，只需要同步主块就可以完成较验；
12）主链和子链的主块关联前一天的主块HASH，只有一天边界的主块才有前一天的边界主块的块HASH，其它主块没有该参数，主要用于全链扫描较验使用，用于轻节点、轻钱包、数据裁剪等功能使用；
13）区块结构：包括区块头1，区块头2，区块体；区块头1：区块编号，时间戳，前一区块HASH，前高度主块HASH（主块才有），前一天主块HASH（一天边界主块才有），区块头2HASH等等（块HASH由区块头1生成）；区块头2：状态根HASH，交易根HASH，奖励交易，布隆过滤器，共识数据等等；区块体：交易表；


二、投票及奖励：
1）验证节点和提案节点需要投票锁定后才能参与共识；
2）投票后有初始锁定期（锁定期在10至30天），锁定期内TOKEN不能流动（锁定期后可以流动），锁定期后需要转出TOKEN，需要一段时间的等待期（一般为一天），等待期后才可以转出TOKEN（等待期目的是防止作恶后立即逃跑的问题）；
3）节点自我投票有最小数量要求，超过最小数量才能成为一个验证节点或提案节点，系统有最小节点自我投票数量要求，但节点可以多自我投票，高自我投票的节点，拥有更高的侯选节点权重，就有更高的被选中的概率，即可获得更高收益（即节点担保费用越高，则收益越高，并更值得投票人信任）；
4）普通用户无法建立节点服务器，或者没有足够的TOKEN达到最小自我投票，则可以选择投票其它节点，同样也能获得收益；
5）节点获得的奖励，按节点各投票人的投票TOKEN数占比来分配奖励；
6）节点主会收取节点拥金，即节点主建立服务器有成本开销，需要向投票人收取拥金来支持成本开销，节点主在创建节点时，需要设置拥金比例（0%~100%），节点地址设置了拥金比例，就不能更改，如需更改，则需要另建节点地址，该功能防止节点主随机更改拥金比例，损害投票人的权益；
7）被选中为侯选节点后，每个节点的收益是相同的，与投票TOKEN数量无关；
8）根据投票TOKEN数来确定侯选验证节点数，按投票权重（投票数和其它参数相关）从高到低选择侯选验证节点，投票权重根据投票TOKEN数、节点自我投票数、网络状态等数据计算而得；
9）奖励利率与投票抵押率和通货膨胀率相关，即块奖励数量周期性变动（一个周期内是固定的），块奖励数根据投票抵押率和通货膨胀率等相关数据计算而得（计算公式待设计）；


三、验证节点：
1）根据投票TOKEN数来确定侯选验证节点数，按投票权重（投票数和其它参数相关）从高到低选择侯选验证节点；
2）通过VRF从侯选验证节点选出验证节点表，验证节点数由侯选验证节点数计算决定，验证节点数要小于侯选验证节点数，即选择一个小集合，每一高度完成一次验证节点的选举；
3）确定性块中的投票才为最终的投票数统计；
4）超过2/3预提交数，则为确定性块；区块验证证明数据：块HASH，验证节点地址，验证签名；
5）在未超过2/3块较验数，则为未确定性块，由权重计算最长链，权重由块较验数计算而得；
6）验证节点给出的最后一块的证明，可以证明前面所有块的有效性；
7）块验证证明数据需要存储在主链上，主链上每10分钟一块，存储当前已完成证明的证明数据，包括子链的证明数据；
8）一个验证节点不能对同一高度（或同一层）的两个块投票证明，如果存在，则认为是恶意节点，给于惩罚，超过1/3的验证节点证明某节点有作恶投票的行为（即同一高度对两个块投票），则标记为作恶节点；
9）被惩罚验证者以及投票人的TOKEN都会被锁定，锁定较长的一段时间后才能转出，并且取消验证者资格；
10）第一轮预投票：被选举的验证节点对区块预投票，如果超过2/3的验证节点完成预投票，则进行第二轮预提交投票；
11）第二轮预提交：被选举的验证节点对区块做预提交投票，如果超过2/3的验证节点完成预提交投票，则区块为确定性区块；
12）侯选验证节点分成N个小组，每个小组为一条链做验证工作；
13）每个高度完成一次小组分配，分配随机数为提案节点选举过程中产生的最小VRF随机HASH；
14）由于每个高度都要进行验证者分组，则每条链的验证者每个高度都发生变化，每条链的验证者都有所有侯选验证节点的随机性；
15）链上程序代码中设置最小GAS价格，所有交易的GAS价格都不能低于该值；链上程序根据链上块中的交易数量，计算出拥堵程度值，然后再计算出最小GAS价格，即越拥堵，GAS价格越高，GAS价格为动态变化的（该变化值不低于前面的最小GAS价格）；社区可以通过治理方式来设置最低GAS价格；提案节点也会配置最小GAS价格，提案者只打包高于该价格的交易，如果配置该价格比前面的动态价格小，则以动态价格为准；


四、提案节点：
1）被计算的主链主块之前的最高确定性块为结束块，计算投票数据；
2）根据投票数据计算侯选验证节点数，按投票权重（投票数和其它参数相关）从高到低选择侯选验证节点，所有节点都能计算出相同的侯选验证节点表；
3）每个侯选验证节点通过VRF计算随机HASH，VRF随机参数为侯选验证节点地址表HASH、侯选验证节点的总投票量、当前计算块HASH，每个验证者计算出来VRF的随机HASH不相同；
4）每个侯选验证节点接收到主链主块后，就立即计算该块的VRF随机HASH并广播；侯选验证节点接收到该随机HASH验证是否合法，不合法，则丢弃，如果合法，则进行下一步计算；
5）侯选验证节点接收到所有侯选验证节点的VRF随机HASH，或者超时（如60秒）结束等待，侯选验证节点将广播自已接收到的最小VRF随机HASH，即对最小VRF随机HASH预投票；
6）预投票为广播最小VRF随机HASH，以及节点接收到VRF随机HASH的侯选验证节点的bitmap（每一位为一个侯选验证节点是否接收VRF随机HASH，bit位为节点地址的索引），在预投票期间，根据统计接收到的bitmap，计算每位bit是否有超过2/3的为1，如果超过，则认为节点已广播完必；
7）如果bitmap有超过2/3的节点已完成广播（统计节点总数为bitmap的1的位数），并且某个VRF随机HASH的投票节点数超过2/3，则完成VRF随机HASH预投票，开始确认投票；如果超时未达到2/3投票，则进行下一轮VRF随机HASH广播和预投票；
8）如果确认投票超过2/3，则确定该HASH是最小VRF随机HASH，即确定该随机HASH对应的节点为提案节点，以该HASH作为随机数，计算后面的提案者表；如果超时未达到2/3投票，则进行下一轮广播和投票；
9）计算下一个提案者，通过对HASH再次计算HASH，得到的HASH作为随机数，选择侯选验证节点表的节点，如果已存在，则重复再计算，直到找完所有需要的提案者；
10）节点P2P连接按配置链连接，可提高同一条链的同步效率；
11）根据节点P2P传输效率评分，评分可增加侯选验证节点的权重；
12）节点可以设置验证或提案那些链的配置，投票统计数据时，按配置数据统计；
13）创建子链是可配置验证节点方案，可选择较少的验证节点而提高TPS，主链在验证节点选举时分配较少的节点；


五、恶意节点行为及惩罚：
1）属于一条链的验证者，却不为该链的区块提供合法性验证；
2）签名了该链一个不合法的区块；
3）不参与到共识流程中；
4）在链两个竞争性的分叉上同时签名；
5）该生产区块未生产区块；
6）不广播提案结束消息；
7）恶意分叉生产区块：不在上一提案者的末尾区块后生产区块，或在两个竞争性的分叉上同时生产区块；
8）对恶意节点惩罚：a）锁定恶意节点自已的投票TOKEN，以及投票该恶意节点的投票人的TOKEN，锁定三个月时间（验证和提案节点有最小自已投票要求）；b）恶意节点地址将永久不能参与验证资格；c）锁定期结束后，将恶意节点自已的投票全部TOKEN转入黑洞地址，并将投票人的TOKEN的10%转入黑洞地址；


六、新节点同步：
1）新节点需要配置其它节点地址或种子服务器地址（DNSEED），才能接入该项目的区块链P2P网络，一般选择配置自已信任的节点或项目方提供的种子服务器地址；
2）新节点通过配置的地址，连接节点或种子服务器，并可在这些节点获取更多节点地址，然后再连接这些节点，扩大连接数量；
3）新节点向连接的节点请求获取最新高度，及最新块HASH，新节点根据多个节点返回的最新高度及块HASH（以及状态ROOT等信息），分析出多数节点确认的最新块HASH，以及与块HASH对应的的节点（其它节点断开连接），新节点从这些节点同步区块及状态数据；
4）新节点向连接的节点请求获取状态数据（状态数据为确认的最新块HASH对应的状态数据），状态数据分成状态片数据，从多个节点分别同时同步，新节点将接收到的状态片数据组合成完整的状态数据（实现高速同步状态数据），并较验状态数据是否正确；
5）新节点向连接的节点请求同步天区块头数据（天区块指每天边界处的区块，它有指向前一天边界区块的块HASH），同步该区块数据用于较验同步的状态数据是否正确，并为后面分段同步提供参数，该同步也只需要同步区块头，即可较验区块链结构；
6）新节点同步区块数据，从最近的区块开始同步，可根据新节点类型，同步部分区块或全部区块或不同步区块；


七）去中心化交易所：
1）实现子链与子链，子链与主链之间TOKEN去中心化交易；
2）采用订单薄模式的去中心化交易所，由节点完成撮合工作，每个节点对撮合交易验证正确性，节点必须按正确的方式执行撮合工作，撮合交易才能被其它节点验证通过，如果节点存在恶意撮合的行为，则会受到惩罚；
3）用户的TOKEN不需要委托给第三方托管，用户整个挂单过程中，用户的TOKEN都在自已的钱包中，只有撮合成功后，用户钱包的TOKEN才会发生变化，所以用户的资产始终撑握在自已的手中；
4）用户使用去中心化钱包发起交易挂单请求（挂单不是交易，不需要上链，但需要对该挂单请求签名），并广播全网，挂单信息包括币对、锚定区块、时间戳、TOKEN数量、价格等信息，用户挂单不会锁定TOKEN，用户挂单后，随时可以使用自已的TOKEN；
5）全网订阅该消息的节点会接收到挂单请求消息，并将该消息缓存内存，将接收到的所有挂单组成挂单表；
6）提案节点在生产区块时，撮合接收到的挂单数据，如果有符合要求的挂单数据，则形成撮合交易，打包到区块中；
7）撮合交易为卖方到买方的交易，包括挂单信息及签名数据，撮合数量，撮合价格等信息；提案节点需要对撮合交易签名，然后打包到区块中；
8）撮合需要同时产生两个交易，分别在两条链上，买卖双向对换的交易，如A和B不两条链上的需要交易的地址，则在A所在链上产生A->B的交易，在B所在链上产生B->A的交易；
9）撮合交易并不是最终确定的交易，需要后面的区块确认后，才生效，即确认后，买到的TOKEN，才能被使用；
10）两条链上的撮合交易所在区块都被确认后（验证者投票确认），在后续的区块中，将撮合交易确认数据分别在两条链上存储，此后，撮合交易完成，买卖双方都可以使用买到的TOKEN；
11）如果在撮合之前，挂单方的用户将TOKEN转出（即余额不够撮合），则提案节点将不会撮合该订单，并将订单从表中删除；
12）如果撮合后，对端链的撮合交易被回滚，则本端链上的撮合交易不能生效，经过一段高度后，撮合取消，撮合交易的TOKEN将返还原用户；
13）如果订单的TOKEN没有被完全撮合，剩余的TOKEN，将继续等待撮合，直到撮合完全；
14）如果用户要主动取消订单，则广播取消挂单消息，节点在收到取消消息，则删除订单表中的订单，如果已撮合的，则不再取消（只取消未撮合部分）；
15）提供修改订单功能，即在不取消订单的情况，修改订单中的TOKEN数和价格，如果已撮合的，则修改失败；
16）挂单信息不会上链，只要挂单信息传递到提案节点，即有机会被撮合，挂单和撮合速度接近中心化交易所；
17）撮合只需要一条交易（单链上）和一条证明，占用链上数据较少；
18）用户挂单后不会锁定TOKEN，并且可以随机取消或修改订单，用户使用更方便；
19）订单或者被撮合，或者被取消，撮合交易被全网节点验证，保证用户TOKEN安全；
20）去中心化交易过程：
  a）用户发起挂单，广播全网；（广播到提案节点的时间：100ms）
  b）提案节点接收到订单，开始撮合，将撮合交易打包进区块，广播全网，让验证者验证；（打包进区块时间小于等于500ms（0.5秒区块间隔时间），可能订单刚到就开始生产区块）
  c）验证者验证通过，区块被确认；（区块广播及验证投票的时间：400ms）
  d）提案节点收集被确认的撮合交易，将撮合确认证明数据打包进区块，广播全网，让验证者验证；（区块间隔时间<=500ms）
  e）验证者验证通过撮合证明数据，区块被确认，则交易完成，用户可以使用交易后的资产；（区块广播及验证投票的时间：400ms）
  f）交易最小完成时间：1秒，交易一般完成时间：4秒


八）桥接链（跨链桥）：
1）桥接链提供将其它链的TOKEN，转移到本区块链系统中（转移为1:1等量转移）；
2）桥接链是条子链，自身是全整的区块链，有完整的验证者提供安全保障；
3）桥接链的验证节点需要同时同步第三方链的区块，并通过第三方链的智能合约锁定TOKEN; 
4）在第三方链中创建跨链智能合约，该合约能锁定被转移的TOKEN，并记录转移信息；从第三方链转移TOKEN到桥接链，则用户需要向跨链智能合约转帐，在合约中锁定转帐的TOKEN，并记录相应信息；
5）可以转移第三方链的智能合约资产，如ETH链的ERC20等；
6）转移到桥接链后，在桥接链会生成对应第三方链的虚拟代币，虚拟代币名为第三方链的币名之前加V，如ETH、USTD，在桥接链上的虚拟代币为VETH、VUSTD；
7）第三方链锁定的TOKEN，和在桥接链生成的虚拟代币是等量的，并且双向成对生效；
8）从桥接链转移TOKEN到第三方链，则是桥接链销毁虚拟代币，并在第三方链释放锁定的TOKEN；销毁和释放成对生效，不能单边生效；
9）第三方链释放锁定的TOKEN，需要桥接链的多数验证节点签名，并调用第三方智能合约方法释放TOKEN；
10）同一条桥接链上可以有多种虚拟代币，每种虚拟代币相互独立；
11）桥接链虚拟代币可以参与去中心化交易所的交易，与其它子链上的代币有相同的交易功能；


九）虚拟代币（TOKEN）:
1）在子链上，除了子链的主币外，可以创建多种虚拟代币，每种虚拟代币在创建时可以指定虚拟代币符号、名称、初始数量、归属地址等信息，并且可以选择绑定智能合约；
2）虚拟代币与主币有相同的功能，可以安全参与交易，虚拟代币交易的交易费由所在子链的主币支付，包括调用智能合给的GAS费用，都由主币支付；
3）虚拟代币的价值由发行者定义，它的价格不影响其它代币的价格；
4）虚拟代币可以参与去中心化交易所的交易，可以与其它代币交换价值；
5）绑定了智能合约的虚拟代币，在虚拟代币转帐时，会自动调用智能合约，合约结果决定交易是否成功，如果合约执行结果为失败，则交易失败，即转帐失效，但GAS费用同样被扣除；
6）虚拟代币绑定的智能合约有合约地址，可以像普通智能合约一样被调用，即向合约地址转帐，调用合约的函数；






